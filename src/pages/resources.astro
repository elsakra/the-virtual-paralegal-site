---
import BaseLayout from '@/layouts/BaseLayout.astro';
import Button from '@/components/Button.astro';
import siteData from '@/data/site.json';

const { company, resources, resourceCategories } = siteData;

// Check if we have any real resources to show
const hasResources = resources && resources.length > 0;
const hasResourceCategories = resourceCategories && resourceCategories.length > 0;
const hasAnyContent = hasResources || hasResourceCategories;
---

<BaseLayout title="Resources" lightHero={true}>
  <!-- Hero -->
  <section class="pt-32 pb-16 bg-gradient-to-b from-primary-50 to-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="max-w-3xl mx-auto text-center">
        <h1 class="font-display text-4xl sm:text-5xl font-bold text-slate-900">
          Resources
        </h1>
        <p class="mt-6 text-xl text-slate-600 leading-relaxed">
          {hasAnyContent 
            ? "Helpful information and resources to guide you through your legal journey."
            : "We're here to help you with your legal needs."
          }
        </p>
      </div>
    </div>
  </section>

  {/* Featured Resources from site.json */}
  {hasResources && (
    <section class="py-16 bg-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="font-display text-2xl font-bold text-slate-900 mb-8">Quick Links</h2>
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
          {resources.map((resource) => (
            <a 
              href={resource.href}
              class="block p-6 bg-primary-50 rounded-xl hover:bg-primary-100 transition-colors"
            >
              <h3 class="font-display text-lg font-bold text-slate-900">
                {resource.title}
              </h3>
              <p class="mt-2 text-slate-600 text-sm">
                {resource.description}
              </p>
              <span class="mt-4 inline-flex items-center text-primary-600 font-medium text-sm">
                {resource.cta || "Learn more"}
                <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
              </span>
            </a>
          ))}
        </div>
      </div>
    </section>
  )}

  {/* Resource Categories - only shown if provided in site.json */}
  {hasResourceCategories && (
    <section class="py-16 bg-slate-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        {resourceCategories.map((category, idx) => (
          <div class:list={["", idx > 0 && "mt-16"]}>
            <h2 class="font-display text-2xl font-bold text-slate-900">
              {category.title}
            </h2>
            {category.description && (
              <p class="mt-2 text-slate-600">
                {category.description}
              </p>
            )}
            {category.items && category.items.length > 0 && (
              <div class="mt-8 grid md:grid-cols-3 gap-6">
                {category.items.map((item) => (
                  <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <h3 class="font-semibold text-slate-900">{item.name}</h3>
                    <p class="mt-2 text-slate-600 text-sm">{item.description}</p>
                    <a 
                      href={item.href}
                      class="mt-4 inline-flex items-center text-primary-600 font-medium text-sm hover:text-primary-700"
                    >
                      {item.cta || "Learn more"}
                      <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                      </svg>
                    </a>
                  </div>
                ))}
              </div>
            )}
          </div>
        ))}
      </div>
    </section>
  )}

  {/* Fallback content when no resources exist */}
  {!hasAnyContent && (
    <section class="py-16 bg-white">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <div class="bg-slate-50 rounded-2xl p-12">
          <svg class="mx-auto h-16 w-16 text-primary-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
          </svg>
          <h2 class="mt-6 font-display text-2xl font-bold text-slate-900">
            Get in Touch
          </h2>
          <p class="mt-4 text-lg text-slate-600">
            Have questions or need assistance? Our team is here to help you understand your options and guide you through the legal process.
          </p>
          <div class="mt-8 flex flex-col sm:flex-row justify-center gap-4">
            <Button href="/contact" style="primary" size="lg">
              Contact Us
            </Button>
            {company?.phone && (
              <Button href={`tel:${company.phone.replace(/[^\d+]/g, '')}`} style="secondary" size="lg">
                Call {company.phone}
              </Button>
            )}
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- CTA -->
  <section class="py-16 bg-primary-900">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="font-display text-3xl font-bold text-white">
        Have Questions?
      </h2>
      <p class="mt-4 text-xl text-primary-200">
        We're here to help. Contact us for a free consultation.
      </p>
      <div class="mt-8">
        <Button href="/contact" style="white" size="lg">
          Contact Us
        </Button>
      </div>
    </div>
  </section>
</BaseLayout>
